 --QUESTION 1
SELECT cname, CONCAT_WS(',',city,state) AS CityState
From Customer
WHERE city>'d'
ORDER BY CityState

--Question 2
SELECT SUM(amount),COUNT(DISTINCT pid),COUNT(DISTINCT sid)
FROM ShippedProduct

--Question 3
SELECT cname,address,pname,amount
FROM Customer,Product,Shipment,ShippedProduct
WHERE Customer.cid=Shipment.cid AND Shipment.sid = ShippedProduct.sid AND ShippedProduct.pid=Product.pid AND (state='IL' OR state='NJ' OR state='CA')

--Question 4
SELECT Customer.cid,cname,COUNT(*) AS numShipments
FROM Customer JOIN Shipment ON Customer.cid = Shipment.cid
WHERE address LIKE '%drive%'
GROUP BY cid


--Question 5
SELECT DISTINCT city,COUNT(Customer.cid) AS numCustomers,COUNT(sid) AS numShipments
FROM Customer JOIN Shipment ON Customer.cid=Shipment.cid
GROUP BY city

--Question 6
SELECT state,SUM(amount*price)
FROM Customer,Product,Shipment,ShippedProduct
WHERE Customer.cid=Shipment.cid AND Shipment.sid = ShippedProduct.sid AND ShippedProduct.pid=Product.pid
GROUP BY state
HAVING SUM(amount*price)<=2000

--Question 7
SELECT Product.pid,pname,COUNT(*)AS numberOfTimesShipped, SUM(amount)AS totalAmountShipped, SUM(amount*price) AS totalValueShipped
FROM Product,Shipment,ShippedProduct
WHERE Shipment.sid = ShippedProduct.sid AND ShippedProduct.pid=Product.pid AND Shipment.shipdate > DATE('2013-02-4')
GROUP BY Product.pid

--Question 8
SELECT p1.pname,p2.pname,a.pid,b.pid,COUNT(a.sid)As numTogether
FROM (ShippedProduct AS a JOIN ShippedProduct AS b ON b.sid=a.sid AND b.pid<>a.pid) JOIN Product AS p1 ON a.pid=p1.pid  JOIN Product AS p2 ON b.pid=p2.pid
GROUP BY p1.pname,p2.pname,a.pid,b.pid
HAVING a.pid>b.pid
ORDER BY a.pid

--Question 9
SELECT pname,inventory
FROM Product
WHERE pname LIKE '%c%' AND inventory<(SELECT AVG(inventory) FROM Product)

--Question 10
SELECT DISTINCT ShippedProduct.pid, pname, price,COUNT(DISTINCT ShippedProduct.sid) AS numShipments,SUM(amount) AS totalShippedAmount,SUM(amount)/COUNT(DISTINCT ShippedProduct.sid) AS avgShippedAmount
FROM Product,ShippedProduct
WHERE Product.pid=ShippedProduct.pid
GROUP BY ShippedProduct.pid
HAVING AVG(amount)<=(SELECT MAX(amount)/COUNT(DISTINCT ShippedProduct.pid) FROM ShippedProduct)
ORDER BY totalShippedAmount ASC



